identity:
  name: "smart_doc_generator"
  author: "luyike"
  label:
    en_US: "Smart Doc Generator"
    zh_Hans: "智能文档生成器"
    pt_BR: "Gerador de Documentos Inteligente"
description:
  human:
    en_US: "Convert Markdown to Word document with automatic chart generation (pie, bar, line charts)"
    zh_Hans: "将Markdown转换为Word文档，支持自动生成图表（饼图、柱状图、折线图）"
    pt_BR: "Converter Markdown para documento Word com geração automática de gráficos (pizza, barras, linhas)"
  llm: "Convert Markdown to Word document with automatic chart generation. Supports pie charts, bar charts, and line charts based on data analysis."
parameters:
  - name: markdown_text
    type: string
    required: true
    label:
      en_US: markdown text
      zh_Hans: markdown 文本
      pt_BR: markdown 文本
    human_description:
      en_US: "md"
      zh_Hans: "md"
      pt_BR: "md"
    llm_description: "md"
    # 使用llm类型：当参数需要根据用户输入和上下文动态生成时
    # 使用form类型：当参数是固定配置项，需要用户预先设置时
    form: llm
  
  - name: templates
    type: string
    required: false
    label:
      en_US: template format
      zh_Hans: 模板格式
      pt_BR: formato de modelo
    human_description:
      en_US: "Template format for document styling"
      zh_Hans: "文档样式模板格式"
      pt_BR: "Formato de modelo para estilo de documento"
    llm_description: "Template format for document styling"
    form: form
  
  - name: style_config
    type: string
    required: false
    label:
      en_US: style configuration
      zh_Hans: 样式配置
      pt_BR: configuração de estilo
    human_description:
      en_US: "Style configuration in JSON format. Use text_style for font settings. Example: {\"text_style\": {\"font_family\": \"微软雅黑\", \"font_size\": 12, \"font_color\": \"#000000\", \"line_spacing\": 1.5, \"page_margins\": 2.5, \"paper_size\": \"A4\", \"heading1_font_family\": \"宋体\", \"heading1_font_size\": 22, \"heading1_font_color\": \"#000000\", \"heading1_bold\": false, \"heading2_font_family\": \"黑体\", \"heading2_font_size\": 16, \"heading2_font_color\": \"#000000\", \"heading2_bold\": true, \"heading3_font_family\": \"黑体\", \"heading3_font_size\": 15, \"heading3_font_color\": \"#000000\", \"heading3_bold\": true, \"heading_font_family\": \"黑体\", \"heading_font_size\": 15, \"heading_font_color\": \"#000000\", \"heading_bold\": true}}"
      zh_Hans: "样式配置（JSON格式）。文字样式配置放在text_style中。示例：{\"text_style\": {\"font_family\": \"微软雅黑\", \"font_size\": 12, \"font_color\": \"#000000\", \"line_spacing\": 1.5, \"page_margins\": 2.5, \"paper_size\": \"A4\", \"heading1_font_family\": \"宋体\", \"heading1_font_size\": 22, \"heading1_font_color\": \"#000000\", \"heading1_bold\": false, \"heading2_font_family\": \"黑体\", \"heading2_font_size\": 16, \"heading2_font_color\": \"#000000\", \"heading2_bold\": true, \"heading3_font_family\": \"黑体\", \"heading3_font_size\": 15, \"heading3_font_color\": \"#000000\", \"heading3_bold\": true, \"heading_font_family\": \"黑体\", \"heading_font_size\": 15, \"heading_font_color\": \"#000000\", \"heading_bold\": true}}"
      pt_BR: "Configuração de estilo em formato JSON. Use text_style para configurações de fonte. Exemplo: {\"text_style\": {\"font_family\": \"Microsoft YaHei\", \"font_size\": 12, \"font_color\": \"#000000\", \"line_spacing\": 1.5, \"page_margins\": 2.5, \"paper_size\": \"A4\", \"heading1_font_family\": \"SimSun\", \"heading1_font_size\": 22, \"heading1_font_color\": \"#000000\", \"heading1_bold\": false, \"heading2_font_family\": \"SimHei\", \"heading2_font_size\": 16, \"heading2_font_color\": \"#000000\", \"heading2_bold\": true, \"heading3_font_family\": \"SimHei\", \"heading3_font_size\": 15, \"heading3_font_color\": \"#000000\", \"heading3_bold\": true, \"heading_font_family\": \"SimHei\", \"heading_font_size\": 15, \"heading_font_color\": \"#000000\", \"heading_bold\": true}}"
    llm_description: "Style configuration in JSON format. Must use text_style object for font settings. Structure: {\"text_style\": {font_family, font_size, font_color, line_spacing (body text, default 1.5), page_margins, paper_size, heading1_font_family, heading1_font_size, heading1_font_color, heading1_bold, heading1_line_spacing (default 1.25, multiplier), heading2_font_family, heading2_font_size, heading2_font_color, heading2_bold, heading2_line_spacing (default 28, points), heading3_font_family, heading3_font_size, heading3_font_color, heading3_bold, heading3_line_spacing (default 28, points), heading_font_family, heading_font_size, heading_font_color, heading_bold, heading_line_spacing (default 28, points, for h4-h6)}}. Note: line_spacing >= 20 is treated as fixed points, < 20 as multiplier. All font-related fields must be inside text_style object."
    form: form
  
  - name: output_file
    type: string
    required: false
    label:
      en_US: output file
      zh_Hans: 输出文件名
      pt_BR: arquivo de saída
    human_description:
      en_US: "Output file name"
      zh_Hans: "输出文件名"
      pt_BR: "Nome do arquivo de saída"
    llm_description: "Output file name for the generated document"
    form: form
  
  - name: enable_charts
    type: boolean
    required: false
    label:
      en_US: enable charts
      zh_Hans: 启用图表生成
      pt_BR: habilitar gráficos
    human_description:
      en_US: "Enable automatic chart generation from data in markdown"
      zh_Hans: "启用从Markdown数据自动生成图表"
      pt_BR: "Habilitar geração automática de gráficos a partir de dados no markdown"
    llm_description: "Enable automatic chart generation from data in markdown"
    form: form
    default: false
  
  - name: chart_data
    type: string
    required: false
    label:
      en_US: Chart Data (JSON)
      zh_Hans: 图表数据（JSON格式）
      pt_BR: Dados do Gráfico (JSON)
    human_description:
      en_US: "Processed chart data in JSON format. Expected format: {\"charts\": [{\"type\": \"pie\"|\"bar\", \"title\": \"...\", \"position\": \"after:...\", \"data\": {...}}]}"
      zh_Hans: "已处理好的图表数据（JSON格式）。期望格式：{\"charts\": [{\"type\": \"pie\"|\"bar\", \"title\": \"...\", \"position\": \"after:...\", \"data\": {...}}]}"
      pt_BR: "Dados do gráfico processados em formato JSON. Formato esperado: {\"charts\": [{\"type\": \"pie\"|\"bar\", \"title\": \"...\", \"position\": \"after:...\", \"data\": {...}}]}"
    llm_description: "Processed chart data in JSON format. Must be a valid JSON string containing charts array with type, title, position, and data fields."
    form: llm
  
  - name: chart_insert_width
    type: number
    required: false
    label:
      en_US: Chart Insert Width (cm)
      zh_Hans: 图表插入宽度（厘米）
      pt_BR: Largura de Inserção do Gráfico (cm)
    human_description:
      en_US: "Width of chart when inserted into Word document (in centimeters). Default is 14.0 cm."
      zh_Hans: "图表插入Word文档时的宽度（厘米）。默认值为14.0厘米。"
      pt_BR: "Largura do gráfico quando inserido no documento Word (em centímetros). O padrão é 14.0 cm."
    llm_description: "Width of chart when inserted into Word document in centimeters. Default is 14.0 cm."
    form: form
    default: 14.0
  
extra:
  python:
    source: tools/markdown_to_word.py
