# 样式配置模板说明

## 文件说明

- `style_config.json.example` - 完整的样式配置模板（JSON格式）
- 此文件展示了所有可用的配置选项和默认值

## 使用方法

### 1. 复制模板文件

```bash
cp style_config.json.example style_config.json
```

### 2. 修改配置

编辑 `style_config.json`，只保留你需要修改的配置项，其他项会自动使用默认值。

### 3. 在代码中使用

```python
import json

# 读取配置文件
with open('style_config.json', 'r', encoding='utf-8') as f:
    style_config = json.load(f)

# 转换为 JSON 字符串传递给 API
style_config_json = json.dumps(style_config)

# 使用
result = markdown_to_word(
    markdown_text="# 标题\n\n内容",
    style_config=style_config_json
)
```

## 配置项说明

### 页面设置 (page)

| 字段 | 类型 | 说明 | 默认值 |
|------|------|------|--------|
| size | string | 纸张大小 (A4/Letter/Legal) | "A4" |
| width | float | 宽度（厘米） | 21.0 |
| height | float | 高度（厘米） | 29.7 |
| orientation | string | 方向 (portrait/landscape) | "portrait" |
| margin_top | float | 上边距（厘米） | 2.5 |
| margin_bottom | float | 下边距（厘米） | 2.5 |
| margin_left | float | 左边距（厘米） | 3.0 |
| margin_right | float | 右边距（厘米） | 2.5 |

### 正文样式 (body)

#### 字体 (font)

| 字段 | 类型 | 说明 | 默认值 |
|------|------|------|--------|
| family | string | 字体名称 | "宋体" |
| size | int | 字号（磅） | 14 |
| color | string | 颜色（十六进制） | "#000000" |
| bold | bool | 粗体 | false |
| italic | bool | 斜体 | false |
| underline | bool | 下划线 | false |

#### 段落 (paragraph)

| 字段 | 类型 | 说明 | 默认值 |
|------|------|------|--------|
| alignment | string | 对齐方式 (left/center/right/justify) | "left" |
| line_spacing | float | 行距 | 28 |
| space_before | float | 段前间距（磅） | 0 |
| space_after | float | 段后间距（磅） | 0 |
| left_indent | float | 左缩进（厘米） | 0 |
| right_indent | float | 右缩进（厘米） | 0 |
| first_line_indent | float | 首行缩进（厘米，0=自动） | 0 |
| keep_together | bool | 段内不分页 | false |
| keep_with_next | bool | 与下段同页 | false |
| page_break_before | bool | 段前分页 | false |

**行距说明**：
- `>= 20`：固定值行距（单位：磅），如 28 表示 28磅固定值
- `< 20`：倍数行距，如 1.5 表示 1.5倍行距

**首行缩进说明**：
- `0`：自动计算两个字符宽度（根据字体大小）
- `> 0`：指定值（单位：厘米）

### 标题样式 (headings)

标题样式支持继承机制：

- `default`：通用默认样式（H4-H6 使用）
- `h1`, `h2`, `h3`：各级标题样式（只需定义差异部分）

**示例**：如果只想修改 H1 的颜色，只需：

```json
{
  "headings": {
    "h1": {
      "font": {
        "color": "#FF0000"
      }
    }
  }
}
```

其他属性会自动继承 `default` 的配置。

### 代码样式

#### 内联代码 (code_inline)

| 字段 | 说明 | 默认值 |
|------|------|--------|
| font | 字体样式 | Consolas 10pt 红色 |
| background_color | 背景色 | "#f5f5f5" |

#### 代码块 (code_block)

| 字段 | 说明 | 默认值 |
|------|------|--------|
| font | 字体样式 | Consolas 9pt |
| paragraph | 段落样式 | 左缩进0.2cm |
| background_color | 背景色 | "#f5f5f5" |

### 表格样式 (table)

| 字段 | 类型 | 说明 | 默认值 |
|------|------|------|--------|
| border_width | float | 边框宽度（磅） | 1.0 |
| border_color | string | 边框颜色 | "#424242" |
| cell_padding | int | 单元格内边距（磅） | 6 |
| cell_alignment | string | 单元格对齐 | "center" |
| cell_font_family | string | 单元格字体 | "微软雅黑" |
| cell_font_size | int | 单元格字号 | 9 |
| header_background | string | 表头背景色 | "#f44336" |
| header_font_color | string | 表头字体颜色 | "#ffffff" |
| header_font_bold | bool | 表头粗体 | true |
| alternate_row_color | string | 交替行背景色 | "#fff3e0" |

### 引用样式 (quote)

| 字段 | 说明 | 默认值 |
|------|------|--------|
| font | 字体样式 | 宋体 10pt 灰色 斜体 |
| paragraph | 段落样式 | 左缩进0.5cm |
| background_color | 背景色 | "#fff3e0" |

### 列表缩进 (list_indent)

| 字段 | 类型 | 说明 | 默认值 |
|------|------|------|--------|
| list_indent | float | 列表缩进（厘米） | 1.27 |

### 图表样式 (chart)

| 字段 | 类型 | 说明 | 默认值 |
|------|------|------|--------|
| width | float | 生成宽度（厘米） | 14.0 |
| insert_width | float | 插入Word宽度（厘米） | 14.0 |
| dpi | int | 图片分辨率 | 150 |
| background_color | string | 背景色 | "#C3C3C3" |
| colors | array | 配色方案（12色） | 见模板 |
| font_sizes | object | 字体大小配置 | 见模板 |
| add_title | bool | 是否添加标题 | false |

### 页码 (enable_page_numbers)

| 字段 | 类型 | 说明 | 默认值 |
|------|------|------|--------|
| enable_page_numbers | bool | 是否启用页码 | true |

## 配置示例

### 示例1：只修改正文字号

```json
{
  "body": {
    "font": {
      "size": 16
    }
  }
}
```

### 示例2：修改标题颜色

```json
{
  "headings": {
    "h1": {
      "font": {
        "color": "#FF0000"
      }
    }
  }
}
```

### 示例3：修改行距

```json
{
  "body": {
    "paragraph": {
      "line_spacing": 1.5
    }
  }
}
```

### 示例4：完整自定义

```json
{
  "page": {
    "margin_top": 3.0,
    "margin_bottom": 3.0
  },
  "body": {
    "font": {
      "family": "微软雅黑",
      "size": 12
    },
    "paragraph": {
      "line_spacing": 1.5,
      "first_line_indent": 0
    }
  },
  "headings": {
    "h1": {
      "font": {
        "family": "黑体",
        "size": 22,
        "bold": true,
        "color": "#FF0000"
      },
      "paragraph": {
        "alignment": "center"
      }
    }
  },
  "chart": {
    "width": 16.0,
    "dpi": 200
  }
}
```

## 注意事项

1. **部分配置**：只需提供要修改的配置项，其他会自动使用默认值
2. **样式继承**：标题样式支持继承，H4-H6 自动继承 `default` 的配置
3. **单位说明**：
   - 字体大小：磅（pt）
   - 边距/缩进：厘米（cm）
   - 间距：磅（pt）
   - 行距：>=20为磅，<20为倍数
4. **颜色格式**：使用十六进制格式，如 "#FF0000"（红色）
5. **字体名称**：使用系统已安装的字体名称

## 常见字体推荐

### 中文字体
- 宋体
- 黑体
- 微软雅黑
- 仿宋_GB2312
- 方正小标宋简体

### 英文字体
- Times New Roman（学术）
- Calibri（商务）
- Arial（通用）
- Consolas（代码）

## 旧格式兼容

系统支持自动迁移旧格式配置：

```json
{
  "text_style": {
    "font_family": "宋体",
    "font_size": 12
  }
}
```

会自动转换为新格式，但建议使用新格式以获得更好的功能。
