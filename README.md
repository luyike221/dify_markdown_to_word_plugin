# Smart Doc Generator (Dify Plugin)

ä¸€ä¸ªæ™ºèƒ½çš„ Markdown è½¬ Word æ–‡æ¡£ç”Ÿæˆå™¨ï¼Œæ”¯æŒè‡ªåŠ¨å›¾è¡¨ç”Ÿæˆï¼ˆé¥¼å›¾ã€æŸ±çŠ¶å›¾ã€æŠ˜çº¿å›¾ï¼‰å’Œçµæ´»çš„æ¨¡æ¿æœºåˆ¶ï¼Œå¯å¿«é€Ÿç”Ÿæˆç¬¦åˆä¸åŒåœºæ™¯éœ€æ±‚çš„æ ¼å¼åŒ– Word æ–‡æ¡£ã€‚

## æ ¸å¿ƒç‰¹æ€§

### ğŸ¨ æ¨¡æ¿æœºåˆ¶ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

æœ¬é¡¹ç›®é‡‡ç”¨**åŒå±‚æ¨¡æ¿æ¶æ„**ï¼Œæä¾›é«˜åº¦å¯å®šåˆ¶çš„æ–‡æ¡£æ ·å¼ç³»ç»Ÿï¼š

- **ä¸»é¢˜ï¼ˆThemeï¼‰**ï¼šå®šä¹‰æ–‡æ¡£çš„æ•´ä½“è§†è§‰é£æ ¼å’Œé…è‰²æ–¹æ¡ˆ
- **æ ·å¼æ¨¡æ¿ï¼ˆStyle Templateï¼‰**ï¼šå®šä¹‰å…·ä½“çš„å­—ä½“ã€æ®µè½ã€è¡¨æ ¼ç­‰å…ƒç´ æ ·å¼
- **æ ·å¼è¦†ç›–ï¼ˆOverridesï¼‰**ï¼šä¸»é¢˜å¯ä»¥è¦†ç›–æ ·å¼æ¨¡æ¿ä¸­çš„ç‰¹å®šè®¾ç½®

é€šè¿‡æ¨¡æ¿æœºåˆ¶ï¼Œæ‚¨å¯ä»¥ï¼š
- å¿«é€Ÿåˆ‡æ¢ä¸åŒçš„æ–‡æ¡£é£æ ¼ï¼ˆå­¦æœ¯ã€å•†åŠ¡ã€ç®€çº¦ç­‰ï¼‰
- å¤ç”¨æ ·å¼é…ç½®ï¼Œä¿æŒæ–‡æ¡£é£æ ¼ä¸€è‡´æ€§
- çµæ´»è‡ªå®šä¹‰ï¼Œæ»¡è¶³ç‰¹å®šåœºæ™¯éœ€æ±‚

### å…¶ä»–ç‰¹æ€§

- âœ… Markdown â†’ Word (.docx) è½¬æ¢
- âœ… **æ™ºèƒ½å›¾è¡¨ç”Ÿæˆ**ï¼šè‡ªåŠ¨è¯†åˆ«æ•°æ®å¹¶ç”Ÿæˆé¥¼å›¾ã€æŸ±çŠ¶å›¾ã€æŠ˜çº¿å›¾
- âœ… å¯é…ç½®çš„å­—ä½“ã€å­—å·ã€è¡Œè·ã€é¡µè¾¹è·ç­‰
- âœ… æ”¯æŒé¡µç ã€é¡µçœ‰é¡µè„š
- âœ… è¿”å›æ–‡æ¡£æ–‡ä»¶å’Œ JSON å…ƒæ•°æ®
- âœ… æ”¯æŒè¡¨æ ¼ã€ä»£ç å—ã€å¼•ç”¨ç­‰ä¸°å¯Œå…ƒç´ 

## æ¨¡æ¿ç³»ç»Ÿæ¶æ„

### ç›®å½•ç»“æ„

```
src/templates/
â”œâ”€â”€ themes/
â”‚   â””â”€â”€ theme_config.yaml      # ä¸»é¢˜é…ç½®æ–‡ä»¶
â””â”€â”€ styles/
    â”œâ”€â”€ default.yaml            # é»˜è®¤æ ·å¼æ¨¡æ¿
    â”œâ”€â”€ academic.yaml           # å­¦æœ¯æ ·å¼æ¨¡æ¿
    â””â”€â”€ business.yaml           # å•†åŠ¡æ ·å¼æ¨¡æ¿
```

### æ¨¡æ¿å±‚æ¬¡å…³ç³»

```
ä¸»é¢˜ï¼ˆThemeï¼‰
  â”œâ”€â”€ å¼•ç”¨æ ·å¼æ¨¡æ¿ï¼ˆstyle_templateï¼‰
  â”œâ”€â”€ å®šä¹‰é…è‰²æ–¹æ¡ˆï¼ˆcolor_schemeï¼‰
  â””â”€â”€ æ ·å¼è¦†ç›–ï¼ˆoverridesï¼‰
      â””â”€â”€ è¦†ç›–æ ·å¼æ¨¡æ¿ä¸­çš„ç‰¹å®šè®¾ç½®
```

### å†…ç½®ä¸»é¢˜

ç³»ç»Ÿå†…ç½®äº†å¤šä¸ªé¢„å®šä¹‰ä¸»é¢˜ï¼Œå¼€ç®±å³ç”¨ï¼š

| ä¸»é¢˜åç§° | é€‚ç”¨åœºæ™¯ | ç‰¹ç‚¹ |
|---------|---------|------|
| `default` | ç³»ç»Ÿå‘Šè­¦æŠ¥å‘Šã€ç›‘æ§æŠ¥å‘Š | æ­£å¼ã€ä¸“ä¸šï¼Œçº¢è‰²ä¸»è‰²è°ƒ |
| `academic` | å­¦æœ¯è®ºæ–‡ | Times New Roman å­—ä½“ï¼ŒåŒå€è¡Œè· |
| `business` | å•†åŠ¡æŠ¥å‘Š | Calibri å­—ä½“ï¼Œç°ä»£å•†åŠ¡é£æ ¼ |
| `minimal` | æŠ€æœ¯æ–‡æ¡£ | æç®€é£æ ¼ï¼ŒHelvetica å­—ä½“ |
| `dark` | æ·±è‰²ä¸»é¢˜æ–‡æ¡£ | æ·±è‰²èƒŒæ™¯ï¼Œé€‚åˆæ¼”ç¤º |
| `colorful` | å½©è‰²æ–‡æ¡£ | ä¸°å¯Œå¤šå½©çš„é…è‰²æ–¹æ¡ˆ |

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ä½¿ç”¨

åœ¨ Dify å·¥ä½œæµä¸­ä½¿ç”¨æ—¶ï¼Œåªéœ€æä¾› Markdown æ–‡æœ¬å’Œé€‰æ‹©æ¨¡æ¿ï¼š

```yaml
markdown_text: "# æ ‡é¢˜\n\nè¿™æ˜¯æ­£æ–‡å†…å®¹..."
templates: "default"  # ä½¿ç”¨é»˜è®¤ä¸»é¢˜
```

### å·¥å…·å‚æ•°

æ‰€æœ‰å‚æ•°å®šä¹‰åœ¨ `tools/markdown_to_word.yaml`ï¼š

#### å¿…éœ€å‚æ•°

- **markdown_text** (string, required): è¦è½¬æ¢çš„ Markdown å†…å®¹

#### å¯é€‰å‚æ•°

- **templates** (string, optional): ä¸»é¢˜/æ¨¡æ¿åç§°ï¼Œé»˜è®¤ `"default"`
  - å¯é€‰å€¼ï¼š`default`, `academic`, `business`, `minimal`, `dark`, `colorful`
  
- **font_family** (string, optional): å­—ä½“æ—ï¼Œé»˜è®¤ `"å¾®è½¯é›…é»‘"`
  - å¸¸ç”¨å€¼ï¼š`"å¾®è½¯é›…é»‘"`, `"å®‹ä½“"`, `"Times New Roman"`, `"Calibri"`, `"Helvetica"`
  
- **font_size** (number, optional): æ­£æ–‡å­—å·ï¼Œé»˜è®¤ `12`
  - å»ºè®®èŒƒå›´ï¼š10-18
  
- **line_spacing** (number, optional): è¡Œè·ï¼Œé»˜è®¤ `1.5`
  - å¸¸ç”¨å€¼ï¼š`1.0`, `1.5`, `2.0`
  
- **page_margins** (number, optional): é¡µè¾¹è·ï¼ˆå˜ç±³ï¼‰ï¼Œé»˜è®¤ `2.5`
  - å»ºè®®èŒƒå›´ï¼š2.0-4.0ï¼Œå››è¾¹ç›¸åŒ
  
- **paper_size** (string, optional): çº¸å¼ å¤§å°ï¼Œé»˜è®¤ `"A4"`
  - å¯é€‰å€¼ï¼š`"A4"`, `"A3"`, `"Letter"`
  
- **output_file** (string, optional): è¾“å‡ºæ–‡ä»¶åï¼Œé»˜è®¤ `"output.docx"`
  
- **add_page_numbers** (boolean, optional): æ˜¯å¦æ·»åŠ é¡µç ï¼Œé»˜è®¤ `true`

### è¾“å‡ºç»“æœ

å·¥å…·ä¼šè¿”å›ä¸¤ä¸ªæ¶ˆæ¯ï¼š

1. **æ–‡ä»¶ï¼ˆBLOBï¼‰**ï¼šç”Ÿæˆçš„ Word æ–‡æ¡£ (.docx)
   - å‡ºç°åœ¨å·¥ä½œæµç»“æœçš„ `files` å­—æ®µä¸­
   - å¯ä»¥ç›´æ¥ä¸‹è½½
   - MIME ç±»å‹ï¼š`application/vnd.openxmlformats-officedocument.wordprocessingml.document`

2. **JSON å…ƒæ•°æ®**ï¼šåŒ…å«è½¬æ¢ç»“æœæ‘˜è¦
   ```json
   {
     "result": "success",
     "output_file": "output.docx",
     "file_size": 12345,
     "settings": {
       "template": "default",
       "font_family": "å¾®è½¯é›…é»‘",
       "font_size": 12,
       ...
     }
   }
   ```

## æ¨¡æ¿é…ç½®è¯¦è§£

### ä¸»é¢˜é…ç½®æ–‡ä»¶

ä¸»é¢˜é…ç½®ä½äº `src/templates/themes/theme_config.yaml`ï¼Œç»“æ„å¦‚ä¸‹ï¼š

```yaml
themes:
  default:
    name: "é»˜è®¤ä¸»é¢˜"
    description: "é€‚ç”¨äºç³»ç»Ÿå‘Šè­¦æŠ¥å‘Šã€ç›‘æ§æŠ¥å‘Šçš„æ­£å¼ä¸»é¢˜"
    style_template: "default.yaml"  # å¼•ç”¨çš„æ ·å¼æ¨¡æ¿
    color_scheme:
      primary: "#d32f2f"      # ä¸»è‰²è°ƒ
      secondary: "#ff9800"    # æ¬¡è¦è‰²
      accent: "#2196f3"       # å¼ºè°ƒè‰²
      background: "#ffffff"   # èƒŒæ™¯è‰²
      text: "#333333"         # æ–‡æœ¬è‰²
      border: "#424242"       # è¾¹æ¡†è‰²
    
    # è‡ªå®šä¹‰æ ·å¼è¦†ç›–
    overrides:
      fonts:
        body:
          name: "å¾®è½¯é›…é»‘"
          size: 11
      headings:
        h1:
          color: "#1a1a1a"
          border_color: "#d32f2f"
      table:
        header_background: "#f44336"
        header_font_color: "#ffffff"
```

### æ ·å¼æ¨¡æ¿æ–‡ä»¶

æ ·å¼æ¨¡æ¿ä½äº `src/templates/styles/` ç›®å½•ï¼Œå®šä¹‰äº†è¯¦ç»†çš„æ ·å¼é…ç½®ï¼š

```yaml
# é¡µé¢è®¾ç½®
page:
  width: 21.0      # cm
  height: 29.7     # cm
  margin_top: 2.5  # cm
  margin_bottom: 2.5
  margin_left: 3.0
  margin_right: 2.5
  orientation: "portrait"

# å­—ä½“è®¾ç½®
fonts:
  body:
    name: "å®‹ä½“"
    size: 14
    color: "#000000"
  
  heading:
    name: "å®‹ä½“"
    size: 16
    bold: true

# æ®µè½è®¾ç½®
paragraph:
  line_spacing: 28  # 28ç£…å›ºå®šå€¼è¡Œè·
  space_before: 0
  space_after: 0
  alignment: "left"

# æ ‡é¢˜æ ·å¼
headings:
  h1:
    font_size: 22
    font_name: "å®‹ä½“"
    alignment: "center"
    line_spacing: 1.25
  
  h2:
    font_size: 16
    font_name: "é»‘ä½“"
    bold: true

# è¡¨æ ¼æ ·å¼
table:
  border_width: 1.0
  border_color: "#424242"
  header_background: "#f44336"
  header_font_color: "#ffffff"
  alternate_row_color: "#fff3e0"

# ä»£ç å—æ ·å¼
code_block:
  background_color: "#f5f5f5"
  border_color: "#d32f2f"
  font_family: "Consolas"
  font_size: 9

# æ›´å¤šæ ·å¼é…ç½®...
```

## è‡ªå®šä¹‰æ¨¡æ¿

### åˆ›å»ºæ–°ä¸»é¢˜

1. **ç¼–è¾‘ä¸»é¢˜é…ç½®**ï¼šåœ¨ `src/templates/themes/theme_config.yaml` ä¸­æ·»åŠ æ–°ä¸»é¢˜ï¼š

```yaml
themes:
  my_custom_theme:
    name: "æˆ‘çš„è‡ªå®šä¹‰ä¸»é¢˜"
    description: "é€‚åˆæˆ‘çš„ä¸šåŠ¡åœºæ™¯çš„ä¸»é¢˜"
    style_template: "default.yaml"  # å¯ä»¥å¤ç”¨ç°æœ‰æ ·å¼æ¨¡æ¿
    color_scheme:
      primary: "#0066cc"
      secondary: "#666666"
      # ...
    overrides:
      fonts:
        body:
          name: "å¾®è½¯é›…é»‘"
          size: 12
      # å…¶ä»–è¦†ç›–è®¾ç½®...
```

2. **åˆ›å»ºæ–°æ ·å¼æ¨¡æ¿**ï¼ˆå¯é€‰ï¼‰ï¼šå¦‚æœéœ€è¦å…¨æ–°çš„æ ·å¼é…ç½®ï¼Œåœ¨ `src/templates/styles/` ç›®å½•åˆ›å»ºæ–°çš„ YAML æ–‡ä»¶ï¼š

```yaml
# my_custom_style.yaml
name: "æˆ‘çš„è‡ªå®šä¹‰æ ·å¼"
description: "è‡ªå®šä¹‰æ ·å¼æè¿°"
version: "1.0.0"

page:
  # é¡µé¢é…ç½®...

fonts:
  # å­—ä½“é…ç½®...

# å…¶ä»–æ ·å¼é…ç½®...
```

3. **ä½¿ç”¨æ–°ä¸»é¢˜**ï¼šåœ¨å·¥å…·è°ƒç”¨æ—¶æŒ‡å®šä¸»é¢˜åç§°ï¼š

```yaml
templates: "my_custom_theme"
```

### ä¸»é¢˜ç»„åˆé…ç½®

ç³»ç»Ÿæ”¯æŒé¢„å®šä¹‰çš„ä¸»é¢˜ç»„åˆï¼Œåœ¨ `theme_config.yaml` ä¸­é…ç½®ï¼š

```yaml
theme_combinations:
  combinations:
    - name: "å­¦æœ¯è®ºæ–‡"
      theme: "academic"
      features:
        - "toc"           # ç›®å½•
        - "footnotes"     # è„šæ³¨
        - "bibliography"  # å‚è€ƒæ–‡çŒ®
        - "page_numbers"  # é¡µç 
    
    - name: "å•†åŠ¡æŠ¥å‘Š"
      theme: "business"
      features:
        - "cover_page"    # å°é¢é¡µ
        - "toc"           # ç›®å½•
        - "header_footer" # é¡µçœ‰é¡µè„š
        - "page_numbers"  # é¡µç 
        - "watermark"     # æ°´å°
```

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šä½¿ç”¨é»˜è®¤ä¸»é¢˜

```yaml
markdown_text: |
  # ç³»ç»Ÿå‘Šè­¦æŠ¥å‘Š
  
  ## å‘Šè­¦æ¦‚è§ˆ
  
  æœ¬æŠ¥å‘ŠåŒ…å«ç³»ç»Ÿç›‘æ§å‘Šè­¦ä¿¡æ¯ã€‚
  
  | å‘Šè­¦çº§åˆ« | æ•°é‡ |
  |---------|------|
  | ä¸¥é‡ | 5 |
  | è­¦å‘Š | 10 |

templates: "default"
add_page_numbers: true
```

### ç¤ºä¾‹ 2ï¼šä½¿ç”¨å­¦æœ¯ä¸»é¢˜

```yaml
markdown_text: |
  # Research Paper Title
  
  ## Abstract
  
  This paper presents...
  
  ## Introduction
  
  ...

templates: "academic"
font_family: "Times New Roman"
line_spacing: 2.0
```

### ç¤ºä¾‹ 3ï¼šä½¿ç”¨å•†åŠ¡ä¸»é¢˜å¹¶è‡ªå®šä¹‰

```yaml
markdown_text: |
  # Business Report
  
  ## Executive Summary
  
  ...

templates: "business"
font_size: 11
page_margins: 2.0
paper_size: "A4"
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.12+
- ä¾èµ–å®‰è£…ï¼š`pip install -r requirements.txt`
- è¿è¡Œä¸­çš„ Dify å®ä¾‹ï¼ˆç”¨äºæ’ä»¶è°ƒè¯•æˆ–å®‰è£…ï¼‰

### è°ƒè¯•æ¨¡å¼

1. å¤åˆ¶ `.env.example` åˆ° `.env`ï¼Œå¡«å†™å¿…è¦çš„é…ç½®å€¼ï¼ˆDify æœåŠ¡å™¨çš„è¿œç¨‹å®‰è£… URL å’Œå¯†é’¥ï¼‰
2. å®‰è£…ä¾èµ–ï¼š`pip install -r requirements.txt`
3. å¯åŠ¨è°ƒè¯•æ¨¡å¼ï¼š`python -m main`
4. åœ¨ Dify â†’ æ’ä»¶ä¸­ï¼Œä½¿ç”¨è°ƒè¯•è¿æ¥åœ¨å·¥ä½œæµä¸­æµ‹è¯•å·¥å…·

### æŸ¥çœ‹ç¤ºä¾‹

ç¤ºä¾‹ Markdown æ–‡ä»¶ä½äº `examples/basic/simple_document.md`

## æ³¨æ„äº‹é¡¹ä¸æ•…éšœæ’é™¤

- å¦‚æœ Dify ç»“æœæ˜¾ç¤ºç©ºçš„ `files` æ•°ç»„ï¼Œè¯·ç¡®ä¿ç¯å¢ƒä½¿ç”¨çš„æ˜¯æ”¯æŒæ–‡ä»¶ BLOB è¿”å›çš„æ’ä»¶ç‰ˆæœ¬ï¼ˆæœ¬é¡¹ç›®å·²æ”¯æŒï¼‰
- éå¸¸å¤§çš„ Markdown è¾“å…¥å¯èƒ½éœ€è¦æ›´é•¿çš„è½¬æ¢æ—¶é—´
- è‡ªå®šä¹‰ä¸»é¢˜æ—¶ï¼Œç¡®ä¿ YAML æ ¼å¼æ­£ç¡®ï¼Œé¿å…è¯­æ³•é”™è¯¯
- å­—ä½“åç§°éœ€è¦ç¡®ä¿ç³»ç»Ÿå·²å®‰è£…å¯¹åº”å­—ä½“ï¼Œå¦åˆ™ä¼šä½¿ç”¨é»˜è®¤å­—ä½“
- æ ·å¼æ¨¡æ¿ä¸­çš„é¢œè‰²å€¼ä½¿ç”¨åå…­è¿›åˆ¶æ ¼å¼ï¼ˆå¦‚ `#d32f2f`ï¼‰

## æ¨¡æ¿ç³»ç»Ÿä¼˜åŠ¿

1. **çµæ´»æ€§**ï¼šé€šè¿‡ä¸»é¢˜å’Œæ ·å¼æ¨¡æ¿åˆ†ç¦»ï¼Œå®ç°é«˜åº¦çµæ´»çš„æ ·å¼å®šåˆ¶
2. **å¯ç»´æŠ¤æ€§**ï¼šæ ·å¼é…ç½®é›†ä¸­ç®¡ç†ï¼Œæ˜“äºç»´æŠ¤å’Œæ›´æ–°
3. **å¯æ‰©å±•æ€§**ï¼šè½»æ¾æ·»åŠ æ–°ä¸»é¢˜å’Œæ ·å¼æ¨¡æ¿ï¼Œæ— éœ€ä¿®æ”¹æ ¸å¿ƒä»£ç 
4. **ä¸€è‡´æ€§**ï¼šé€šè¿‡æ¨¡æ¿ç¡®ä¿æ–‡æ¡£é£æ ¼çš„ä¸€è‡´æ€§
5. **æ˜“ç”¨æ€§**ï¼šé¢„å®šä¹‰ä¸»é¢˜å¼€ç®±å³ç”¨ï¼Œé™ä½ä½¿ç”¨é—¨æ§›

## éšç§è¯´æ˜

è¯¦è§ `PRIVACY.md` æ–‡ä»¶ã€‚

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›æ¨¡æ¿ç³»ç»Ÿå’ŒåŠŸèƒ½ã€‚
