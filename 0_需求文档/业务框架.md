graph TB
    %% 输入层
    subgraph "输入层 (Input Layer)"
        MD[Markdown文件]
        TXT[文本字符串]
        BATCH[批量文件]
        CONFIG[配置文件]
    end

    %% 接口层
    subgraph "接口层 (Interface Layer)"
        CLI[命令行界面]
        GUI[图形界面]
        API[Web API]
    end

    %% 核心处理层
    subgraph "核心处理层 (Core Processing Layer)"
        
        subgraph "解析模块 (Parser Module)"
            MDPARSER[Markdown解析器]
            VALIDATOR[格式验证器]
            PREPROCESSOR[预处理器]
        end
        
        subgraph "转换引擎 (Conversion Engine)"
            CONVERTER[格式转换器]
            STYLEMANAGER[样式管理器]
            TEMPLATEENGINE[模板引擎]
        end
        
        subgraph "内容处理器 (Content Processors)"
            TEXTPROC[文本处理器]
            TABLEPROC[表格处理器]
            IMAGEPROC[图片处理器]
            CODEPROC[代码块处理器]
            MATHPROC[数学公式处理器]
            LINKPROC[链接处理器]
        end
    end

    %% 支持服务层
    subgraph "支持服务层 (Support Services)"
        FILEMANAGER[文件管理器]
        IMGDOWNLOADER[图片下载器]
        CACHE[缓存服务]
        LOGGER[日志服务]
        ERRORHANDLER[异常处理器]
    end

    %% 输出生成层
    subgraph "输出生成层 (Output Generation Layer)"
        DOCBUILDER[Word文档构建器]
        FORMATTER[格式化器]
        OPTIMIZER[优化器]
    end

    %% 存储层
    subgraph "存储层 (Storage Layer)"
        TEMPLATES[(样式模板库)]
        TEMP[(临时文件)]
        OUTPUT[(输出文件)]
    end

    %% 配置管理层
    subgraph "配置管理层 (Configuration Layer)"
        SETTINGS[系统设置]
        PROFILES[转换配置]
        STYLES[样式配置]
    end

    %% 数据流连接
    MD --> CLI
    TXT --> CLI
    BATCH --> CLI
    
    MD --> GUI
    TXT --> GUI
    BATCH --> GUI
    
    MD --> API
    TXT --> API
    
    CONFIG --> SETTINGS
    
    CLI --> MDPARSER
    GUI --> MDPARSER
    API --> MDPARSER
    
    MDPARSER --> VALIDATOR
    VALIDATOR --> PREPROCESSOR
    PREPROCESSOR --> CONVERTER
    
    CONVERTER --> TEXTPROC
    CONVERTER --> TABLEPROC
    CONVERTER --> IMAGEPROC
    CONVERTER --> CODEPROC
    CONVERTER --> MATHPROC
    CONVERTER --> LINKPROC
    
    TEXTPROC --> DOCBUILDER
    TABLEPROC --> DOCBUILDER
    IMAGEPROC --> DOCBUILDER
    CODEPROC --> DOCBUILDER
    MATHPROC --> DOCBUILDER
    LINKPROC --> DOCBUILDER
    
    STYLEMANAGER --> DOCBUILDER
    TEMPLATEENGINE --> DOCBUILDER
    
    FILEMANAGER --> TEMP
    IMGDOWNLOADER --> TEMP
    CACHE --> TEMP
    
    DOCBUILDER --> FORMATTER
    FORMATTER --> OPTIMIZER
    OPTIMIZER --> OUTPUT
    
    TEMPLATES --> TEMPLATEENGINE
    SETTINGS --> CONVERTER
    PROFILES --> CONVERTER
    STYLES --> STYLEMANAGER
    
    LOGGER -.-> CONVERTER
    ERRORHANDLER -.-> CONVERTER
    
    %% 样式定义
    classDef inputLayer fill:#e1f5fe
    classDef interfaceLayer fill:#f3e5f5
    classDef coreLayer fill:#e8f5e8
    classDef supportLayer fill:#fff3e0
    classDef outputLayer fill:#fce4ec
    classDef storageLayer fill:#f1f8e9
    classDef configLayer fill:#e0f2f1
    
    class MD,TXT,BATCH,CONFIG inputLayer
    class CLI,GUI,API interfaceLayer
    class MDPARSER,VALIDATOR,PREPROCESSOR,CONVERTER,STYLEMANAGER,TEMPLATEENGINE,TEXTPROC,TABLEPROC,IMAGEPROC,CODEPROC,MATHPROC,LINKPROC coreLayer
    class FILEMANAGER,IMGDOWNLOADER,CACHE,LOGGER,ERRORHANDLER supportLayer
    class DOCBUILDER,FORMATTER,OPTIMIZER outputLayer
    class TEMPLATES,TEMP,OUTPUT storageLayer
    class SETTINGS,PROFILES,STYLES configLayer